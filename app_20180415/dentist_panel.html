<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="robots" content="index, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="author" content="https://github.com/aaa/">
    <title>덴탈플러스</title>
    <link href="css/fontawesome/css/fontawesome-all.css" rel="stylesheet"> <!-- font awesome 5.* pro -->
	<link rel="stylesheet" href="css/dentalBasic.css">
	
	<script src="js/jquery-1.12.4.min.js"></script>
    <script src="js/common.js"></script>
	<script src="js/handlebars.min.js"></script>
	<style>
		.dental-panel .dental-icon-nav { border: 1px solid #c7c7c7; border-top: none; }
		.dental-panel .icon-nav-item { flex-basis: 25%; border-radius: 0; padding: 4rem .2rem .3rem .2rem; }
		.dental-panel .dental-icon-nav .icon-nav-item { border: none; border-right: 1px solid #c7c7c7; border-top: 1px solid #c7c7c7; }
		.dental-panel .dental-icon-nav .icon-nav-item:nth-child(4n) { border-right: 0; }
		.dental-panel .icon-nav-item .nav-item-icon { font-size: 1.6rem; top: 40%; left: 50%; transform: translate(-50%, -50%); color: #0083cb;}
		.dental-panel .icon-nav-item .nav-item-title { font-size: 0.8rem; }
	</style>
</head>
<body>
    <header class="register-header navbar">
        <section class="navbar-section">
            <span onclick="if(history.length>2){ history.back(); } else { location.href='start.html'; }">
                <i class="fal fa-arrow-square-left"></i>
                이전페이지
            </span>
        </section>
        <section class="navbar-section">
            <a href="start.html"><i class="fal fa-home"></i></a>
            <a href="user_panel.html"><i class="fal fa-user-alt"></i></a>
        </section>
    </header>
    <section class="user-panel-section dental-panel">
		<div class="dental-panel-header">
			<div class="user-photo">
				<div class="hospital-log-box">
					<div class="logo-frame-hospital">
						<!-- 이미지 url 입력하면 됨 -->
						<!-- width: 최소 100px 최대 150xp, min-height: 50px, 가운데 정렬임 -->
						<!-- 사이즈 관련 디테일 좀 더 고민해야함 필요 -->
						<img src="" id="hospitalLogo">
						<span class="user-photo-box-icon" id="hospitalLogoArea"><i class="camera-icon"></i></span>
					</div>
				</div>
				<input type="file" id="uploadHospitalLogo" accept="image/*" capture="camera" hidden>
                <script>
                    
                
                </script>
				<div class="user-photo-title" id="userEmail">sjw0927@ gmail.com</div>
				<div class="user-photo-subtitle" id="hospitalName">서울역 앞 치과 병원</div>
			</div>
		</div>
		<div class="panel-nav">
			<nav class="dental-icon-nav">
				<a class="icon-nav-item" href="register_dentist.html">
					<span class="nav-item-icon"><i class="fal fa-hospital"></i></span>
					<span class="nav-item-title">병원정보</span>
				</a>
				<a class="icon-nav-item" href="hospital_interaction.html">
					<span class="nav-item-icon"><i class="fal fa-file-plus"></i></span>
					<span class="nav-item-title">공고등록</span>
				</a>
				<a class="icon-nav-item" href="hospital_interaction.html">
					<span class="nav-item-icon"><i class="fal fa-file-edit"></i></span>
					<span class="nav-item-title">공고수정</span>
				</a>
				<a class="icon-nav-item" href="hospital_interaction.html">
					<span class="nav-item-icon"><i class="fal fa-newspaper"></i></span>
					<span class="nav-item-title">공고알리기</span>
				</a>
				<a class="icon-nav-item" href="hr_management.html">
					<span class="nav-item-icon"><i class="fal fa-user-circle"></i></span>
					<span class="nav-item-title">지원자관리</span>
				</a>
				<a class="icon-nav-item" href="hr_management.html">
					<span class="nav-item-icon"><i class="fal fa-address-book"></i></span>
					<span class="nav-item-title">추천인재</span>
				</a>
				<a class="icon-nav-item" href="hr_management.html">
					<span class="nav-item-icon"><i class="fal fa-users"></i></span>
					<span class="nav-item-title">인재열람</span>
				</a>
				<a class="icon-nav-item" href="payment_completion_history.html">
					<span class="nav-item-icon"><i class="fal fa-credit-card"></i></span>
					<span class="nav-item-title">결제내역</span>
				</a>
			</nav>
		</div>
		<div class="panel-body">
			<input type=radio name="dental-panel" id="dental-panel-tab1" hidden>
			<input type=radio name="dental-panel" id="dental-panel-tab2" hidden>
			<input type=radio name="dental-panel" id="dental-panel-tab3" hidden>
			<input type=radio name="dental-panel" id="dental-panel-tab4" hidden>
			<input type=radio name="dental-panel" id="dental-panel-tab5" hidden>
			<input type=radio name="dental-panel" id="dental-panel-tab6" hidden>
			<input type=radio name="dental-panel" id="dental-panel-tab7" hidden>
			<input type=radio name="dental-panel" id="dental-panel-tab8" hidden>
			<div class="tab-content"></div>
			<div class="tab-content"></div>
			<div class="tab-content"></div>
			<div class="tab-content"></div>
			<div class="tab-content"></div>
			<div class="tab-content"></div>
			<div class="tab-content"></div>
			<div class="tab-content"></div>
		</div>
		<div class="panel-footer"></div>
	</section>
	<!-- dental need to login 모달 -->
	<div class="dental-modal modal" id="loginModal">
		<input type="checkbox" id="dental-modal-login" name="modal-toggle"> <!-- 모달 체크박스 -->
		<label for="dental-modal-login">로그인 요청 모달</label> <!-- 모달 체크박스 레이블-->
		<label for="dental-modal-login"><div class="modal-overlay"></div></label> <!-- 배경, 체크박스로 하면 배경을 레이블로 해서 모달 죽일 수 있음-->
		<div class="modal-overlay-class"></div> <!-- 클래스로 오픈시 배경, 배경 누르면 모달 닫히게 이벤트 걸어야함-->
		<div class="modal-container columns">
			<div class="modal-header">
				<div class="modal-title">로그인이 필요합니다.</div>
				<label for="dental-modal-login" rel="dental-modal" title="닫기"><i class="fa fa-window-close"></i></label>
			</div>
			<div class="modal-body">
				<div class="dental-form-card card login-section" style="padding-top: 1.2rem;">
					<form id="" name="">
						<div class="card-body">
							<div class="basic col-11" style="background-color: #2a5082; line-height: 3rem; font-size: 0.9rem; color: #FFF; ">
								<i class="fa fa-facebook-official" style="margin: 0 0.5rem; font-size: 1.2rem;"></i>
								<span>페이스북으로 로그인 하기</span>
							</div>
							<div class="divider" data-content="또는"></div>
							<div id="bizRegNoStatus"></div>
							<div class="basic col-11">
								<input type="text" id="email" name="email" placeholder="이메일 아이디" >
								<span class="form-acc"></span>
							</div>
							<div id="emailStatus"></div>
							<div class="basic col-11">
								<input type="password" id="passwordConfirm" name="passwordConfirm" placeholder="비밀번호" >
								<span class="form-acc"></span>
							</div>
							<div class="basic col-11">
								<button type="submit" class="btn btn-primary" >로그인</button>
								<label style="margin-left: 0.5rem"><input type="checkbox"><span style="margin-left: 0.5rem;">로그인 상태 유지</span></label>
						   </div>
						</div>
			
						<div class="card-footer loginFooter">
							<div class="checkRegister">
									<a href="divide_register.html">
										<span>아직 회원이 아니세요?</span>
										<span>회원가입</span>
									</a>
								</div>
								<div class="findPassword">
									<span>아이디 찾기</span>
									<span class="spanVdivider"></span>
									<span>비밀번호 찾기</span>
								</div>
						</div>
					</form>
				</div>
			</div>
			<div class="modal-footer"></div>
		</div>
	</div>
	<!-- dental need to premium register 모달 -->
	<div class="dental-modal modal" id="regPremiumModal">
		<input type="checkbox" id="dental-modal-reg-premium" name="modal-toggle"> <!-- 모달 체크박스 -->
		<label for="dental-modal-reg-premium"> 프리미엄 회원가입 요청 모달</label> <!-- 모달 체크박스 레이블-->
		<label for="dental-modal-reg-premium"><div class="modal-overlay"></div></label> <!-- 배경, 체크박스로 하면 배경을 레이블로 해서 모달 죽일 수 있음-->
		<div class="modal-overlay-class"></div> <!-- 클래스로 오픈시 배경, 배경 누르면 모달 닫히게 이벤트 걸어야함-->
		<div class="modal-container columns">
			<div class="modal-header">
				<div class="modal-title"> 프리미엄 회원 서비스</div>
				<div class="modal-desc">해당 서비스를 이용하기 위해서 프리미엄 회원가입을 해주세요.</div>
				<label for="dental-modal-reg-premium" rel="dental-modal" title="닫기"><i class="fa fa-window-close"></i></label>
			</div>
			<div class="modal-body">
				<p style="font-size: 0.6rem;">구인 활동이 꾸준하거나 인재풀을 평상시에도 관리하고 싶다면</p>
				<p style="font-size: 1.2rem; font-weight: bold; margin-bottom: 0.5rem;">덴탈플러스 프리미엄회원!</p>
				<div class="btn btn-primary" style="margin-bottom: 0.5rem;">가입하기</div>
				<br>
				1. 합리적인 가격에 pc, 모바일, 앱까지 모두 한번에! 직접 비교해보세요!
				<br>
				2. 추가로, 채용공고 알리기 비용이 50% OFF!
				<br>
				3. 우리 병원 채용공고가 라이브플러스 상단에 노출!
				 <p style="padding-left: 1rem; font-size: 0.5rem;">- 무료회원, 외부 제휴 공고 상위에 노출됩니다.</p>
				 <p style="padding-left: 1rem; font-size: 0.5rem;">- 같은 프리미엄회원의 경우 마감일 기준으로 정렬됩니다.</p>
				<br>
				4. 쉽고 파워풀한 인재풀관리 기능!
				<p style="padding-left: 1rem; font-size: 0.5rem;">- 구직자가 공개한 이력서 열람 및 연락가능</p>
				<p style="padding-left: 1rem; font-size: 0.5rem;">- 우리병원 주소를 관심지역, 우리동네로 설정한 구직자 이력서 열람.</p>
				<p style="padding-left: 1rem; font-size: 0.5rem;">- 우리 병원을 팔로우한 구직자 이력서 열람.</p>
				<p style="padding-left: 1rem; font-size: 0.5rem;">- 우리 병원 채용공고를 스크랩한 구직자 이력서 열람 기능.</p>
				<p style="padding-left: 1rem; font-size: 0.5rem;">- 별도로 관심 인재에 대한 스크랩 기능 지원.</p>
			</div>
			<div class="modal-footer"></div>
		</div>
	</div>
</body>
</html>

<script>
	
var ResumeManagementApp = (function() {

	var hospitalId;

	function init() {

		// 로그인 확인
		if ( !LOGIN_INFO.isLoggedIn() ) {
			alert("로그인이 필요합니다.");
			location.href = "login.html";
			// 로그인 페이지 이동
			return;
		}

		if ( !LOGIN_INFO.isHospitalMember() ) {
			alert("병원 회원만 사용하실 수 있는 기능입니다.")
			window.history.back();
			// 앞 페이지로 점프
			return;
		}

		// 기존 정보를 로드해서 보여 준다.
		var userId = LOGIN_INFO.getId();
		// 병원 정보를 로드한다.
		// 기본 정보 로드
        callApi("GET", "/api/user/"+userId+"/basicHospitalInfo/", null,
            function(basicInfo) {
				console.log(basicInfo);
				
				hospitalId = basicInfo.id;

                document.getElementById("userEmail").innerText = basicInfo.email;
				document.getElementById("hospitalName").innerText  = basicInfo.name;
				
				if ( basicInfo.fullLogoUrl ) {
					document.getElementById("hospitalLogo").src = basicInfo.fullLogoUrl;
				}
            },
            function(errorCode, errorMsg) {
                alert("에러 [" + errorCode + "] ==> [" + errorMsg + "]");
            }
        );

	}

	init();



	function onChangeHospitalLogo(event) {
		event.preventDefault();

		console.log("병원 ID : ", hospitalId);

		if ( !hospitalId ) {
			alert("로그인되어 있지 않습니다.");
			return;
		}

		console.log("업로드 대상 : ", this.value);
		var files = event.target.files;
		var filesArr = Array.prototype.slice.call(files);

		filesArr.forEach(function(file) {
			if ( !file.type.match("image.*") ) {
				alert("이미지 파일만 업로드 가능합니다.");
				return;
			}
			console.log("업로드 대상 파일 확인 완료 : ", file);
			console.log("AAA : ", file.name, "   ", file.type);
		});


		var file = files[0];    // 첫번째 파일만 처리
		console.log("업로드할 파일 ", file);
		var formData = new FormData();
		formData.append("file", file);

		//console.log(formData);

		var userId = LOGIN_INFO.getId();
		uploadFile("/api/hospital/"+hospitalId+"/logo/", formData,
			function(resData) {
				console.log("파일 업로드 성공 : ", resData);
				document.getElementById("userPic").src = resData + "?" + (Math.random()*1000);
			},
			function(errorCode, errorMsg) {
				alert("사용자 프로필 이미지 등록에 실패했습니다. [" + errorCode + "]");
			}
		);
		
		// $.ajax({
		// 	url : API_SERVER_URL + "/api/hospital/"+hospitalId+"/logo/",
		// 	processData: false,
		// 	contentType: false,
		// 	data: formData,
		// 	type: 'POST',
		// 	success: function(result) {
		// 		console.log("성공 : ", result);
				
		// 		document.getElementById("hospitalLogo").src = result._RESPONSE_ + "?" + (Math.random()*1000);                                
		// 	}
		// });

	}

	document.getElementById("uploadHospitalLogo").addEventListener("change", onChangeHospitalLogo);
	document.getElementById("hospitalLogoArea").addEventListener("click", function(e) {
		document.getElementById("uploadHospitalLogo").click();
	});
})();
</script>
