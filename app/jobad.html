<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="robots" content="index, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="author" content="https://github.com/aaa/">
    <title>덴탈플러스</title>
    <link href="css/fontawesome/css/fontawesome-all.css" rel="stylesheet"> <!-- font awesome 5.* pro -->
	<link rel="stylesheet" href="css/dentalBasic.css">

    <script src="js/jquery-1.12.4.min.js"></script>
    <script src="js/handlebars.min.js"></script>
    <script src="js/common.js"></script>
    <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?clientId=sTJvEhCjdAWmt5nFZblm"></script>
    <script src="js/dental_ui.js"></script>
</head>
<body>
    <header class="register-header navbar">
        <section class="navbar-section">
            <span onclick="if(history.length>2){ history.back(); } else { location.href='start.html'; }">
                <i class="fal fa-arrow-square-left"></i>
                이전페이지
            </span>
        </section>
        <section class="navbar-section">
            <a href="liveboard.html"><i class="fal fa-home"></i></a>
            <a href="user_panel.html"><i class="fal fa-user-alt"></i></a>
        </section>
    </header>
    <section class="jobad-top">
        <div class="dental-info-card">
            <div class="info-card-header">
                <div class="info-card-title-styled" id="jobAd-title-1">***욜씨미 일하겠습니다.욜씨미 일하겠습니다.욜씨미 일하겠습니다.욜씨미 일하겠습니다.욜씨미 일하겠습니다.</div>
            </div>
            <div class="info-card-body">
                <div class="hospital-info">
                    <div class="hospital-info-box">
                        <div class="hospital-log-box">
                            <div class="logo-frame-hospital"><img id="hospital-logoUrl" src="{{fullLogoUrl}}" onload="imageFit(this, 100);"></div>
                        </div>
                    </div>
                    <div class="hospital-info-box">
                        <p class="hospital-name" id="hospital-name-1">***우리은행 치과</p>
                        <div class="hospital-info-divider"></div>
                        <div class="jobad-detail">
                            <span class="jobad-d-day" id="jobAd-dDay">***D-20</span>
                            <div class="divider-vert"></div>
                            <label><input type="checkbox" id="chkInterestHospital" hidden><span class="like-icon" title="좋아요"></span></label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <nav class="jobad-nav">
        <span><a href="#jobpost-info">채용정보</a></span>
        <span><a href="#hospital-info">기본정보</a></span>
        <span><a href="#hospital-map">위치정보</a></span>
    </nav>
    <section class="jobad-fixed-layer">
        <div class="info-card-title-styled" id="jobAd-title-2">***밝고 즐거운 열정넘지는 신입/경력 치위생사 선생님을 모십니다. </div>
        <nav class="jobad-nav">
            <span><a href="#jobpost-info">채용정보</a></span>
            <span><a href="#hospital-info">기본정보</a></span>
            <span><a href="#hospital-map">위치정보</a></span>
        </nav>
    </section>
    <section id="jobpost-info" class="recruit-info">
        <div class="dental-info-card">
            <div class="info-card-header">
                <div class="info-card-header-title">모집요강</div>
            </div>
            <div class="info-card-body">
                <ul id="divAttrs" class="info-card-list"></ul><!-- 공고 속성 출력 -->
                <ul class="info-card-list">
                    <li class="info-card-item">
                        <span class="info-card-item-title">채용인원</span>
                        <p id="jobAd-hiringCnt" class="info-card-item-desc">***00명</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">급여</span>
                        <p id="jobAd-salary" class="info-card-item-desc">***면접 후 협의</p>
                    </li>
                </ul>
            </div>
            <script>
                function renderAttrs(attrVal) {
                    //console.log("*** renderAttrs : ", attrVal);
                    var htmlStr = "";
                    var attrCodes = CODE_CONTAINER.getAttrs();
                    attrCodes.forEach(function(group) {
                        htmlStr += "<li class='info-card-item'>" + "<span class='info-card-item-title'>" + group.text + "</span>";
                        htmlStr += "<p class='info-card-item-desc'>";
                        var groupChecked = false;
                        group.element.forEach(function(attr) {                        
                            for ( var i=0; attrVal && i<attrVal.length; i++ ) {
                                //console.log("attrVal [" + attrVal[i] + "] , attr.value [" + attr.value + "]");
                                if ( attrVal[i]==attr.value ) {
                                    htmlStr += "<span class='info-card-item-desc-elm'>" + attr.text + "</span>&nbsp;";
                                    groupChecked = true;
                                    console.log("** renderAttrs : attrVal 잡았음 [" + attrVal[i] + "] , attr.value [" + attr.value + "](" + attr.text + ")");
                                }
                            }
                        });
                        if ( !groupChecked ) {
                            htmlStr += "<span>무관</span>";
                        }

                        htmlStr += "</p></li>";

                    });
                    
                    //console.log(htmlStr);
                    document.getElementById("divAttrs").innerHTML = htmlStr;
                }

                // 테스트 코드
                // var attrVal =  [
                //             "EMP.1",
                //             "AREA.2",
                //             "AREA.5",
                //             //"TASK.9"
                //             ];
                // renderAttrs(attrVal);
            
            </script>
        
  <!--     위의 스크립트는 아래와 같은 코드를 만들게 됨. 디자인 수정 시 아래를 수정해 주시고, 말씀해주셈
            <div class="card-body">
                    <div id="divAttrs">
                        <div>고용형태</div>
                        <div>
                            <p id="attrVal" data-tag="attrVal">***</p>
                            <p class="textDesc"></p>
                        </div>

                        <div>채용부문</div>
                        <div>
                            <p id="attrVal" data-tag="attrVal">***</p>
                            <p class="textDesc"></p>
                        </div>

                        <div>담당업무</div>
                        <div>
                            <p>***진료실</p>
                            <p class="text-desc">* 상황에 따라 협의 하에 변동이 있을 수 있습니다. </p>
                        </div>
                    </div>

                    <div>채용인원</div>
                    <div><p id="jobAd-hiringCnt">***00명</p></div>
                    <div>급여</div>
                    <div><p>***면접 후 협의</p></div>
            </div>
        -->



        </div>
        <div class="dental-info-card card">
            <div class="info-card-header">
                <div class="info-card-header-title">자격요건</div>
            </div>
            <div class="info-card-body">
                <ul class="info-card-list">
                    <li class="info-card-item">
                        <span class="info-card-item-title">학력</span>
                        <p id="jobAd-eduLevel" class="info-card-item-desc">***무관(졸업예정자 가능)</p>
                        <p class="info-card-item-desc2"></p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">경력</span>
                        <p id="jobAd-expType" class="info-card-item-desc">***신입/경력</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">자격요건</span>
                        <p id="jobAd-licenseText" class="info-card-item-desc">***치위생사 면허증 또는 간호조무사 자격증</p>
                    </li>
                </ul>
            </div>
        </div>
        <div class="dental-info-card">
            <div class="info-card-header">
                <div class="info-card-header-title">근무환경</div>
            </div>
            <div class="info-card-body">
                <ul class="info-card-list">
                    <li class="info-card-item">
                        <span class="info-card-item-title">근무지역</span>
                        <p id="hospital-locationText" class="info-card-item-desc">***서울> 강남구> 역삼동</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">근무요일</span>
                        <p id="jobAd-workingDay" class="info-card-item-desc">***월/화/수</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">근무시간</span>
                        <ul class="info-card-sublist2">
                            <li class="info-card-subitem2">
                                <span class="info-card-subitem-title2">평일</span>
                                <p id="jobAd-workingTimeWeekday" class="info-card-item-desc3">***09시 ~ 18시</p>
                            </li>
                            <li class="info-card-subitem2">
                                <span class="info-card-subitem-title2">주말</span>
                                <p id="jobAd-workingTimeWeekend" class="info-card-item-desc3">***09시 ~ 18시</p>
                            </li>
                            <li class="info-card-subitem2">
                                <span class="info-card-subitem-title2">참고 사항</span>
                                <p id="jobAd-workingTimeText" class="info-card-item-desc3">***09시 ~ 18시</p>
                            </li>
                        </ul>                    
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">점심시간</span>
                        <p class="info-card-item-desc">
                            <span id="jobAd-lunchTimeStart">***13시</span>
                            <span>~</span>
                            <span id="jobAd-lunchTimeEnd">***13시</span>
                            <span>***(1시간)</span>
                        </p>
                        <p class="info-card-item-desc2">* 상황에 따라 협의 하에 변동이 있을 수 있습니다. </p>
                    </li>
                </ul>
            </div>
        </div>
        <div class="dental-info-card">
            <div class="info-card-header">
                <div class="info-card-header-title">접수기간 및 방법</div>
            </div>
            <div class="info-card-body">
                <ul class="info-card-list">
                    <li class="info-card-item">
                        <span class="info-card-item-title">시작일</span>
                        <p id="jobAd-hiringStartDate" class="info-card-item-desc txt-red">***</p>
                    </li>
                    <li class="info-card-item">
                            <span class="info-card-item-title">마감일</span>
                            <p id="jobAd-hiringEndDate" class="info-card-item-desc">***2017. 11. 18. (토) 18시</p>
                            <p class="info-card-item-desc2">* 마감일은 기업의 사정, 조기마감 등으로 변경될 수 있습니다.</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">접수방법</span>
                        <ul id="divApplyWay" class="info-card-sublist">
                            <!-- <button class="btn btn-primary" name="jobAd-applyWay" value="homepage"    hidden disabled>병원홈페이지 ></button>
                            <button class="btn btn-primary" name="jobAd-applyWay" value="oneclick"    hidden disabled>원클릭지원 ></button>
                            <button class="btn btn-primary" name="jobAd-applyWay" value="email"       hidden disabled>이메일지원 ></button>
                            <button class="btn btn-primary" name="jobAd-applyWay" value="tel"         hidden disabled>전화 문의 ></button> -->
                        </ul>
                    </li>
                </ul>
                
                <script>

                    //getApplyWay
                    var htmlApplyWay = "";
                    CODE_CONTAINER.getApplyWay().forEach(function(way) {
                        if ( way.value == '') return;   // 전체인 경우는 표시 안함
                        htmlApplyWay += '<button class="info-card-chip" name="jobAd-applyWay" value="' + way.value + '" hidden disabled>' + way.text + ' ></button>';
                    });
                    document.getElementById("divApplyWay").innerHTML = htmlApplyWay;


                    // 지원방법을 클릭했을 때, 이벤트 처리
                    function onClickApply(event) {
                        console.log(this.value);
                    }
                    document.querySelectorAll("[name='jobAd-applyWay']").forEach(function(el) {
                        el.addEventListener("click", onClickApply);
                    });


                    // 지원방법의 값을 로드한 데이터로 세팅
                    function setupApplyWay(arr) {
                        if ( !arr || !Array.isArray(arr) || arr.length<1 ) return;
                        
                        document.querySelectorAll("[name='jobAd-applyWay']").forEach(function(el) {
                            el.hidden = true;
                            el.disabled = true;
                        });

                        arr.forEach(function(e) {
                            var target = document.querySelector("[name='jobAd-applyWay'][value='" + e + "']");
                            if ( target ) {
                                target.hidden = false;
                                target.disabled = false;
                            }
                        });
                    }
                </script>
            </div>
        </div>
        <div class="dental-info-card">
            <div class="info-card-header"><div class="info-card-header-title">문의처</div></div>
            <div class="info-card-body">
                <ul class="info-card-list">
                    <li class="info-card-item">
                        <span class="info-card-item-title">담당자</span>
                        <p id="jobAd-hrOfficerName" class="info-card-item-desc">***김샛별 대리</p>
                        <p class="info-card-item-desc2"></p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">이메일</span>
                        <p id="jobAd-hrEmail" class="info-card-item-desc">***tomotafn@naver.com</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">전화</span>
                        <p id="jobAd-hrTelNo" class="info-card-item-desc">***042-537-8620</p>
                    </li>
                </ul>
            </div>
        </div>
    </section>
    <section id="hospital-info" class="hospital-info">
        <div class="dental-info-card">
            <div class="info-card-header">
                <div class="info-card-header-title">기본정보</div>
            </div>
            <div class="info-card-body">
                <ul class="info-card-list">
                    <li class="info-card-item">
                        <span class="info-card-item-title">사업장명</span>
                        <p id="hospital-bizRegName" class="info-card-item-desc">***우리은행 치과</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">병원명</span>
                        <p id="hospital-name-2" class="info-card-item-desc">***우리은행 치과</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">병원구분</span>
                        <p id="hospital-hospitalType" class="info-card-item-desc">***통신판매중계업</p>
                    </li>

                    <li class="info-card-item">
                        <span class="info-card-item-title">설립일</span>
                        <p id="hospital-estDate" class="info-card-item-desc" data-tag="estDate">***1989년 12월 11일(15년)</p>
                    </li>

                    <li class="info-card-item">
                        <span class="info-card-item-title">대표자명</span>
                        <p id="hospital-ceoName" class="info-card-item-desc" data-tag="hospitalCEONm">***변사장</p>
                    </li>

                    <li class="info-card-item">
                        <span class="info-card-item-title">홈페이지</span>
                        <p id="hospital-hospUrl" class="info-card-item-desc" data-tag="hospUrl">***</p>
                    </li>

                    <li class="info-card-item">
                        <span class="info-card-item-title">주소</span>
                        <p class="info-card-item-desc"><span id="hospital-addrMain" data-tag="addr">***</span> <span id="hospital-addrDetail" data-tag="addr">***</span></p>
                    </li>
                </ul>
            </div>
        </div>
        <div class="dental-info-card">
            <div class="info-card-header">
                <div class="info-card-header-title">진료 정보</div>
            </div>
            <div class="info-card-body">
                <ul class="info-card-list">
                    <li class="info-card-item">
                        <span class="info-card-item-title">휴일 휴진</span>
                        <p id="hospital-holyday" class="info-card-item-desc">***주말 휴진</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">진료 시간</span>
                        <ul class="info-card-sublist2">
                            <li class="info-card-subitem2">
                                <span class="info-card-subitem-title2">평일</span>
                                <p id="hospital-workingTimeWeekday" class="info-card-item-desc3">***주말 휴진</p> 
                            </li>
                            <li class="info-card-subitem2">
                                <span class="info-card-subitem-title2">주말</span>
                                <p id="hospital-workingTimeWeekend" class="info-card-item-desc3">***주말 휴진</p>
                            </li>
                            <li class="info-card-subitem2">
                                <span class="info-card-subitem-title2">참고 사항</span>
                                <p id="hospital-workingTimeText" class="info-card-item-desc3">***주말 휴진</p>
                            </li>
                        </ul>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">점심시간</span>
                        <p class="info-card-item-desc">
                            <span id="hospital-lunchTimeStart">***13시30분</span>
                            <span>~</span>
                            <span id="hospital-lunchTimeEnd">***13시30분</span>
                        </p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">직원 구성</span>
                        <p id="hospital-totalMemberCnt" class="info-card-item-desc">***00명</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">진료 과목</span>
                        <p id="hospital-clinicSubject" class="info-card-item-desc">***교정</p>
                    </li>
                <!--
                    <li class="info-card-item">
                        <span class="info-card-item-title">이메일</span>
                        <p id="hospital-email" class="info-card-item-desc">***gmarket@gmail.com</p>
                    </li>
                -->
                </ul>

            </div>
        </div>
        <div class="dental-info-card">
            <div class="info-card-header">
                <h1 class="info-card-header-title">위치/교통 정보</h1>
            </div>
            <div class="info-card-body">
                <ul class="info-card-list">
                    <li class="info-card-item">
                        <span class="info-card-item-title">지하철</span>
                        <p class="info-card-item-desc">***7호선 중화역 3번출구</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">시내버스</span>
                        <p class="info-card-item-desc">***240, 241A, 241B, 1122, 2012, 2113, 2223, 2234</p>
                    </li>
                    <li class="info-card-item">
                        <span class="info-card-item-title">주변 명소</span>
                        <p class="info-card-item-desc">***서울성모병원, ***강남고속버스터미널 남쪽 200m</p>
                    </li>
                </ul>
            </div>
        </div>
        <div id="hospital-map" class="dental-info-card" style="height:400px; margin: 6px auto 30px;">
            지도를 표시할 수 없습니다.
        </div>


    </section>
    <section class="jobad-btm-layer">
        <div class="jobad-btm-layer-btn">
            <label class="scrap-box">
                <input type="checkbox" name="scrap" id="checkboxScrap" hidden>
                <i class="fas fa-star"></i>
                스크랩
            </label>
        </div>
        <div class="jobad-btm-layer-btn">
            <label class="applying-box">
                <input type="button"  id="btnApply" hidden>
                <i class="far fa-hand-point-up"></i>
                원클릭지원
            </label>
        </div>
        <div class="jobad-btm-layer-btn" id="btnCall">
            <label class="calling-box">
                <input type="button" name="" hidden>
                <i class="far fa-phone-square"></i>
                전화문의
            </label>
        </div>
        <div class="jobad-btm-float-btn">
            <label class="go-to-top">
                <input type="button" name="" hidden>
                <i class="far fa-arrow-circle-up"></i>
            </label>
        </div>
    </section>
    <footer class="footer">
    footer
    </footer>
    <script>
        $(window).on('scroll', function() {
            if($(window).scrollTop()>200) {
                $('.jobad-fixed-layer, .jobad-btm-layer').css({
                    position: "fixed",
                    "z-index": "3"
                }).fadeIn(400);
            }
            else if ($(window).scrollTop()<=200){
                $('.jobad-fixed-layer, .jobad-btm-layer').fadeOut(100);
            }
        });
    </script>
</body>
</html>

<script>

function getText(value) {
    if ( value ) {
        if ( typeof value === "string" ) return value.trim();
        else return value;
    } else return "";
}

function fillData(resData) {
	if ( resData.hospital.interestedByUserId ) {
		if ( LOGIN_INFO.isLoggedIn() && LOGIN_INFO.isPersonalMember() ) {
			if ( LOGIN_INFO.getId()==resData.hospital.interestedByUserId )	document.getElementById("chkInterestHospital").checked = true;
		}
	}

	document.getElementById("chkInterestHospital").checked

    document.getElementById("hospital-name-1").innerText            = getText(resData.hospital.hospitalName);
    document.getElementById("hospital-name-2").innerText            = getText(resData.hospital.hospitalName);
    document.getElementById("hospital-logoUrl").src                 = getText(resData.hospital.fullLogoUrl);    // {{fullLogoUrl}}
    document.getElementById("jobAd-title-1").innerText              = getText(resData.title);
    document.getElementById("jobAd-title-2").innerText              = getText(resData.title);
    document.getElementById("hospital-locationText").innerText      = getText(resData.hospital.sidoName) + "> " + getText(resData.hospital.location.siguName) + "> " + getText(resData.hospital.location.emdNm);
    document.getElementById("jobAd-hiringStartDate").innerText      = getText(resData.hiringStartDate);
    document.getElementById("jobAd-hiringEndDate").innerText        = getText(resData.hiringEndDate);

    document.getElementById("jobAd-hrOfficerName").innerText        = getText(resData.hrOfficerName);
    document.getElementById("jobAd-hrTelNo").innerText              = getText(resData.hrTelNo);
    document.getElementById("jobAd-hrEmail").innerText              = getText(resData.hrEmail);

    document.getElementById("hospital-bizRegName").innerText        = getText(resData.hospital.bizRegName);
    document.getElementById("hospital-estDate").innerText           = getText(resData.hospital.estDate);
    document.getElementById("hospital-ceoName").innerText           = getText(resData.hospital.ceoName);
    document.getElementById("hospital-hospUrl").innerText           = getText(resData.hospital.hospitalUrl);
    document.getElementById("hospital-addrMain").innerText          = getText(resData.hospital.location.addrMain);
    document.getElementById("hospital-addrDetail").innerText        = getText(resData.hospital.location.addrDetail);

    document.getElementById("hospital-lunchTimeStart").innerText    = getText(resData.hospital.lunchTimeStart);
    document.getElementById("hospital-lunchTimeEnd").innerText      = getText(resData.hospital.lunchTimeEnd);
    document.getElementById("hospital-totalMemberCnt").innerText    = getText(resData.hospital.totalMemberCnt) + " 명";
    document.getElementById("hospital-clinicSubject").innerText     = getText(resData.hospital.clinicSubject);
    //document.getElementById("hospital-email").innerText             = getText(resData.hospital.email;
    //document.getElementById("hospital-telNo").innerText             = getText(resData.hospital.telNo;

    document.getElementById("jobAd-licenseText").innerText          = getText(resData.licenseText);
    console.log("==> ", resData.expType, " ==> ",  CODE_CONTAINER.getCode(resData.expType, CODE_CONTAINER.getExpType) );
    document.getElementById("jobAd-expType").innerText              = CODE_CONTAINER.getCode(resData.expType, CODE_CONTAINER.getExpType).text;
    document.getElementById("jobAd-eduLevel").innerText             = CODE_CONTAINER.getCode(resData.eduLevel, CODE_CONTAINER.getEduLevel).text;

    // // 공고 - 평일/휴일/기타 근무시간
    var jobAdWorkingTimeWeekday = "";
    if ( resData.jobWorkingTimeWeekdayStart ) jobAdWorkingTimeWeekday += getText(resData.jobWorkingTimeWeekdayStart);
    if ( resData.jobWorkingTimeWeekdayEnd )   jobAdWorkingTimeWeekday += " ~ " + getText(resData.jobWorkingTimeWeekdayStart);

    var jobAdWorkingTimeWeekend = "";
    if ( resData.jobWorkingTimeWeekendStart ) jobAdWorkingTimeWeekend += getText(resData.jobWorkingTimeWeekendStart);
    if ( resData.jobWorkingTimeWeekendEnd )   jobAdWorkingTimeWeekend += " ~ " + getText(resData.jobWorkingTimeWeekendEnd);

    var jobAdWorkingTimeText = "";
    if ( resData.jobWorkingTimeText ) jobAdWorkingTimeText += getText(resData.jobWorkingTimeText);

    document.getElementById("jobAd-workingTimeWeekday").innerText   = getText(jobAdWorkingTimeWeekday);
    document.getElementById("jobAd-workingTimeWeekend").innerText   = getText(jobAdWorkingTimeWeekend);
    document.getElementById("jobAd-workingTimeText").innerText      = getText(jobAdWorkingTimeText);
    document.getElementById("jobAd-workingDay").innerText           = getText(resData.jobWorkingDay);


    renderAttrs(resData.attr);


    // D-Day 부분
    if ( !resData.dday || resData.dday < 0 ) {
        document.getElementById("jobAd-dDay").innerText             = "종료";
    } else {
        document.getElementById("jobAd-dDay").innerText             = "D-" + getText(resData.dday);
    }

    document.getElementById("jobAd-hiringCnt").innerText            = getText(resData.hiringCnt) + " 명";


    document.getElementById("jobAd-lunchTimeStart").innerText       = getText(resData.jobLunchTimeStart);
    document.getElementById("jobAd-lunchTimeEnd").innerText         = getText(resData.jobLunchTimeEnd);

    //console.log("attr: ", resData.jobAd.attr);

    // 급여 부분
    var salary = "";
    if ( !resData.salaryType || resData.salaryType=="0" ) {
        if ( resData.salaryText ) salary = getText(resData.salaryText);
        else salary = "*** 오류";
    } else {
        var salaryCode = CODE_CONTAINER.getCode(resData.salaryType, CODE_CONTAINER.getSalaryType);
        if ( salaryCode ) salary = getText(salaryCode.text);
        else salaryCode = "***코드 오류";
    }
    console.log("SALARY : ", salary);
    document.getElementById("jobAd-salary").innerText               = salary;
    //jobAd-salary

    // 지원방법
    setupApplyWay(resData.applyWay);

    // 병원 - 평일/휴일/기타 근무시간
    var hospitalWorkingTimeWeekday = "";
    if ( resData.hospital.workingTimeWeekdayStart ) hospitalWorkingTimeWeekday += getText(resData.hospital.workingTimeWeekdayStart);
    if ( resData.hospital.workingTimeWeekdayEnd )   hospitalWorkingTimeWeekday += " ~ " + getText(resData.hospital.workingTimeWeekdayStart);

    var hospitalWorkingTimeWeekend = "";
    if ( resData.hospital.workingTimeWeekendStart ) hospitalWorkingTimeWeekend += getText(resData.hospital.workingTimeWeekendStart);
    if ( resData.hospital.workingTimeWeekendEnd )   hospitalWorkingTimeWeekend += " ~ " + getText(resData.hospital.workingTimeWeekendEnd);

    var hospitalWorkingTimeText = "";
    if ( resData.hospital.workingTimeText ) hospitalWorkingTimeText += getText(resData.hospital.workingTimeText);

    document.getElementById("hospital-workingTimeWeekday").innerText    = getText(hospitalWorkingTimeWeekday);
    document.getElementById("hospital-workingTimeWeekend").innerText    = getText(hospitalWorkingTimeWeekend);
    document.getElementById("hospital-workingTimeText").innerText       = getText(hospitalWorkingTimeText);





    // 휴일 휴진        hospital-holyday  holiday
    var holidayStr = "";
    var holidayVal = resData.hospital.holiday;
    if ( holidayVal && Array.isArray(holidayVal) && holidayVal.length>0 ) {
        var holidayLen = holidayVal.length;
        CODE_CONTAINER.getHolyday().forEach(function(holiday) {
            for ( var i=0; i<holidayLen; i++ ) {
                if ( holidayVal[i] == holiday.value ) {                    
                    if ( holidayVal[i] == "0" ) {
                        holidayStr += holiday.text + "(" + resData.hospital.holidayText + ")";
                    } else {
                        holidayStr += holiday.text + ", ";
                    }
                }
            }
        });
        document.getElementById("hospital-holyday").innerText       = holidayStr;
        //console.log(holidayStr);
    }


    // hospital-hospitalType : 단일행
    var hospitalTypeStr = "";
    if ( !resData.hospital.hospitalTypeCode )               hospitalTypeStr = "***에러";
    else if ( resData.hospital.hospitalTypeCode=="0" )      hospitalTypeStr = getText(resData.hospital.hospitalTypeText);
    else                                                    hospitalTypeStr = CODE_CONTAINER.getCode(resData.hospital.hospitalTypeCode, CODE_CONTAINER.getHospitalTypeCode).text;
    //console.log("===> ", hospitalTypeStr);
    document.getElementById("hospital-hospitalType").innerText = hospitalTypeStr;

    



    /* ***************************************************************************************************************** */
    // NAVER 지도 API 호출
    if ( resData.hospital.location.latLonY && resData.hospital.location.latLonX ) {

        //var myLatLng = naver.maps.UTMK.fromUTMKToLatLng({x:950983.9495052507, y:1942264.442479183});  // 서울대 아이원
        //var myLatLng = naver.maps.UTMK.fromUTMKToLatLng({x:959392.6806814834, y:1944538.8317065234});   // 역삼동 해오름
        //var myLatLng = naver.maps.UTMK.fromUTMKToLatLng({x:resData.hospital.addrJuso.entX, y:resData.hospital.addrJuso.entY});

        var myLatLng = new naver.maps.LatLng(resData.hospital.location.latLonY, resData.hospital.location.latLonX);
        console.log(myLatLng);
        var map = new naver.maps.Map('hospital-map', {
            //center: new naver.maps.LatLng(35.1737670166000,129.1811629440000),
            center: new naver.maps.LatLng(myLatLng),
            zoom: 10
        });
        var marker = new naver.maps.Marker({
            //position: new naver.maps.LatLng(35.1737670166000,129.1811629440000),
            position: new naver.maps.LatLng(myLatLng),
            map: map
        });
    } else {
        console.log("좌표 데이터 없음");
    }
    /* ***************************************************************************************************************** */
}

            



var JobAdDetailApp = (function() {

	var jobAdId;
	var hospitalId;

    // 병원 기본 정보 수신
    function loadJobAdWithHospital() {


        var params = getHtmlCallParams();
        if ( params && params.jobAdId ) {   // 기존 공고 로드 후 수정
            jobAdId = params.jobAdId;
        } else {
            alert("잘못된 접근입니다.");
            return;
        }

		var apiParam = null;
		if ( LOGIN_INFO.isLoggedIn() && LOGIN_INFO.isPersonalMember() ) {
			apiParam = "userId=" + LOGIN_INFO.getId();
		}
        
        callApi("GET", "/api/jobAd/" + jobAdId + "/detail/", apiParam,
            function(jobAdData) {
                console.log(jobAdData);
                if ( !jobAdData ) {
					alert("해당 공고를 찾을 수 없습니다.");

					// BACK을 하여야 하나?
					return;
				}
				
				hospitalId = jobAdData.hospitalId;
				checkInterestHospital();

                fillData(jobAdData);
                
            },
            function(errorCode, errorMsg) {
                alert("에러 [" + errorCode + "] ==> [" + errorMsg + "]");
            }
		);

		// 관심병원 check
		function checkInterestHospital() {
			if ( !LOGIN_INFO.isLoggedIn() || !LOGIN_INFO.isPersonalMember() ) return;

			
			callApi("GET", "/api/user/"+LOGIN_INFO.getId()+"/interestHospitalId/", null,
				function(interestHospitalIds) {
					if ( !interestHospitalIds ) return;

					for ( var i=0; i<interestHospitalIds.length; i++ ) {
						if ( interestHospitalIds[i]==hospitalId) {
							document.getElementById("chkInterestHospital").checked = true;
							break;
						}
					}

				},
				function(errorCode, errorMsg) {
					console.log("에러 1 [" + errorCode + "] ==> [" + errorMsg + "]");
					alert("관심병원 정보를 가져올 수 없습니다. [" + errorCode + "] ==> [" + errorMsg + "]");
				}
			);
			
		}
		

    }


    loadJobAdWithHospital();



	// 관심병원 등록/해제		chkInterestHospital
	function onChangeInterestHospital(event) {
		if ( !jobAdId || !hospitalId ) return;

        if (!LOGIN_INFO.isLoggedIn()) {
            event.preventDefault();
			alert("관심병원 등록을 위해서는 로그인이 필요합니다.");
			document.getElementById("chkInterestHospital").checked = false;
            return;
		}
		if ( !LOGIN_INFO.isPersonalMember() ) {
			event.preventDefault();
			alert("관심병원 등록은 개인 회원만 가능합니다.");
			document.getElementById("chkInterestHospital").checked = false;
			return;
		}

		if ( this.checked ) {
			callApi("POST", "/api/user/"+LOGIN_INFO.getId()+"/interestHospitalId/"+hospitalId+"/", null,
				function(interestHospitalIds) {
					if ( !interestHospitalIds ) return;

					for ( var i=0; i<interestHospitalIds.length; i++ ) {
						if ( interestHospitalIds[i]==hospitalId) {
							document.getElementById("chkInterestHospital").checked = true;
							alert("관심병원으로 등록되었습니다.");
							break;
						}
					}

				},
				function(errorCode, errorMsg) {
					document.getElementById("chkInterestHospital").checked = false;
					console.log("에러 1 [" + errorCode + "] ==> [" + errorMsg + "]");
					alert("관심병원 등록에 실패했습니다. [" + errorCode + "] ==> [" + errorMsg + "]");
				}
			);

        } else {
			callApi("DELETE", "/api/user/"+LOGIN_INFO.getId()+"/interestHospitalId/"+hospitalId+"/", null,
				function(interestHospitalIds) {
					if ( !interestHospitalIds ) return;
					
					document.getElementById("chkInterestHospital").checked = false;
					for ( var i=0; i<interestHospitalIds.length; i++ ) {
						if ( interestHospitalIds[i]==hospitalId) {
							document.getElementById("chkInterestHospital").checked = true;
							break;
						}
					}
					alert("관심병원이 해제되었습니다.");

				},
				function(errorCode, errorMsg) {
					document.getElementById("chkInterestHospital").checked = true;
					console.log("에러 1 [" + errorCode + "] ==> [" + errorMsg + "]");
					alert("관심병원 등록에 실패했습니다. [" + errorCode + "] ==> [" + errorMsg + "]");
				}
			);

        }
	}
	document.getElementById("chkInterestHospital").addEventListener("change", onChangeInterestHospital);
	




	// 스크랩 
	
	document.getElementById("checkboxScrap").checked = false;
	if ( LOGIN_INFO.isLoggedIn() && LOGIN_INFO.isPersonalMember() ) {
		var scrappedJobAdIds = LOGIN_INFO.getScrappedJobAdIds();
		if ( scrappedJobAdIds ) {			
			for ( var i=0; i<scrappedJobAdIds.length; i++ ) {
				if ( scrappedJobAdIds[i]==jobAdId ) {
					document.getElementById("checkboxScrap").checked = true;
					break;
				}
			}
		}
	}

    function onChangeCheckboxScrap(event) {
		if ( !jobAdId ) return;

        if (!LOGIN_INFO.isLoggedIn()) {
            event.preventDefault();
			alert("스크랩을 위해서는 로그인이 필요합니다.");
			document.getElementById("checkboxScrap").checked = false;
            return;
		}
		if ( !LOGIN_INFO.isPersonalMember() ) {
			event.preventDefault();
			alert("스크랩은 개인 회원만 가능합니다.");
			document.getElementById("checkboxScrap").checked = false;
			return;
		}

		console.log("일반 공고 스크랩 ", jobAdId );
		//console.log("현재 상태 : " + this.checked);
        
        if ( this.checked ) {
            LOGIN_INFO.addScrappedJobAdId(jobAdId, function() {
				document.getElementById("checkboxScrap").checked = true;
			});
        } else {
            LOGIN_INFO.removeScrappedJobAdId(jobAdId, function() {
				document.getElementById("checkboxScrap").checked = false;
			});
        }
    }
    document.getElementById("checkboxScrap").addEventListener("change", onChangeCheckboxScrap);
	

	// 원클릭 지원
	function onClickBtnOneClickApply(event) {
		if ( !jobAdId ) return;

        if (!LOGIN_INFO.isLoggedIn()) {
            event.preventDefault();
            alert("원클릭 지원을 위해서는 로그인이 필요합니다.");
            return;
		}
		if ( !LOGIN_INFO.isPersonalMember() ) {
			event.preventDefault();
			alert("원클릭 지원은 개인 회원만 가능합니다.");
			return;
		}

		console.log("원클릭지원 ", jobAdId );
		

		// 먼저 기등록 여부 판단하여야 함
		callApi("GET", "/api/user/"+LOGIN_INFO.getId()+"/appliedJobAdId/", null,
			function(resData) {
				console.log(resData);

				var alreadyApplied = false;
				if ( resData && Array.isArray(resData) ) {
					for ( var i=0; i<resData.length; i++ ) {
						if ( resData[i] == jobAdId ) {
							alreadyApplied = true;
							break;
						}
					}
				}

				if ( alreadyApplied ) {
					alert("이미 지원한 공고입니다.");
					return;
				}
				
				var goApply = confirm("해당 공고에 바로 지원하시겠습니까?");
				if ( goApply ) {
					callApi("POST", "/api/user/"+LOGIN_INFO.getId()+"/appliedJobAdId/"+jobAdId+"/", null,
						function(result) {
							console.log(result);
							alert("지원하셨습니다.");
						},
						function(errorCode, errorMsg) {
							console.log("에러 2 [" + errorCode + "] ==> [" + errorMsg + "]");
							alert("에러 2 [" + errorCode + "] ==> [" + errorMsg + "]");
						}
					);

				} else {
					alert("지원하지 않으셨습니다.");
				}


			},
			function(errorCode, errorMsg) {
				console.log("에러 1 [" + errorCode + "] ==> [" + errorMsg + "]");
				alert("에러 1 [" + errorCode + "] ==> [" + errorMsg + "]");
			}
		);
        
        
    }
	document.getElementById("btnApply").addEventListener("click", onClickBtnOneClickApply);
	

	// 전화문의 : 전화문의는 병원회원 자신도 가능 ??? ==> 결정 필요
	function onClickBtnCall(event) {
        if (!LOGIN_INFO.isLoggedIn()) {
            event.preventDefault();
            alert("원클릭 지원을 위해서는 로그인이 필요합니다.");
            return;
		}

		// if ( !LOGIN_INFO.isPersonalMember() ) {
		// 	event.preventDefault();
		// 	alert("전화문의는 개인 회원만 가능합니다.");
		// 	return;
		// }

        console.log("전화문의 ", jobAdId );
        document.location.href='tel:010-7209-3356';
        
    }
    document.getElementById("btnCall").addEventListener("click", onClickBtnCall);

})();

</script>
